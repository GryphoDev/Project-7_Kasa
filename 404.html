<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Single Page App</title>
    <script type="text/javascript">
      /**
       * Reorganizes the URL for SPA routing:
       * - Keeps the first `pathSegmentsToKeep` segments of the path.
       * - Moves the rest into the query string prefixed by "/?/".
       * - Replaces "&" with "~and~" to avoid conflicts.
       * - Redirects to the new URL format.
       */
      var pathSegmentsToKeep = 1;
      var l = window.location;
      l.replace(
        l.protocol +
          "//" +
          l.hostname +
          (l.port ? ":" + l.port : "") +
          l.pathname
            .split("/")
            .slice(0, 1 + pathSegmentsToKeep)
            .join("/") +
          "/?/" +
          l.pathname
            .slice(1)
            .split("/")
            .slice(pathSegmentsToKeep)
            .join("/")
            .replace(/&/g, "~and~") +
          (l.search ? "&" + l.search.slice(1).replace(/&/g, "~and~") : "") +
          l.hash
      );
    </script>
  </head>
  <body></body>
</html>
